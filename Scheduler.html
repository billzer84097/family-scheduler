<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Summer Scheduler 2026</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --unavailable-color: #e74c3c;
            --available-color: #ffffff;
            --weekend-bg: #f4f4f4;
            --border-color: #ddd;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            margin: 0 0 10px 0;
            color: var(--primary-color);
            font-size: 1.8rem;
        }

        p.instructions {
            color: #666;
            font-size: 1rem;
            line-height: 1.5;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dot {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        .dot.free { background-color: var(--available-color); }
        .dot.busy { background-color: var(--unavailable-color); }

        /* Calendar Grid Styles */
        .month-container {
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .month-header {
            background-color: var(--primary-color);
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background-color: #eee;
            border-bottom: 1px solid var(--border-color);
        }

        .day-name {
            padding: 8px 0;
            text-align: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: #555;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }

        .day-cell {
            aspect-ratio: 1; /* Keeps cells square */
            border-right: 1px solid #eee;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.1s;
            user-select: none;
            position: relative;
        }

        .day-cell:nth-child(7n) { border-right: none; } /* Remove right border on last column */
        
        /* Weekend Styling */
        .day-cell:nth-child(7n), .day-cell:nth-child(7n-6) {
            background-color: var(--weekend-bg);
        }

        .day-cell.empty {
            background-color: #fafafa;
            cursor: default;
        }

        .day-cell.unavailable {
            background-color: var(--unavailable-color) !important;
            color: white;
        }

        /* Controls Section */
        .controls {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            height: 80px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-family: monospace;
            box-sizing: border-box; /* Fixes padding width issues */
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 5px;
        }

        button:hover {
            opacity: 0.9;
        }
        
        button.secondary {
            background-color: #7f8c8d;
        }

        .status-msg {
            margin-top: 10px;
            font-size: 0.9rem;
            font-weight: bold;
            color: green;
            min-height: 1.2em;
        }

        /* Mobile Optimization */
        @media (max-width: 600px) {
            body { padding: 10px; }
            .container { padding: 15px; }
            h1 { font-size: 1.5rem; }
            .day-cell { font-size: 0.9rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Summer 2026 Planner</h1>
        <p class="instructions">Tap any date to mark it as <strong>Unavailable</strong>. <br>Any date left White is a day everyone is free!</p>
        
        <div class="legend">
            <div class="legend-item">
                <div class="dot free"></div>
                <span>Available</span>
            </div>
            <div class="legend-item">
                <div class="dot busy"></div>
                <span>Unavailable</span>
            </div>
        </div>
    </header>

    <div id="calendar-wrapper">
        <!-- Calendars will be injected here via JavaScript -->
    </div>

    <div class="controls">
        <h3>How to share with other families:</h3>
        <p>Since this is a simple tool without a server, follow these steps:</p>
        
        <div class="control-group">
            <strong>1. Save your changes:</strong><br>
            <button onclick="generateSaveCode()">Get Save Code</button>
            <div id="copy-status" class="status-msg"></div>
            <p style="font-size: 0.85rem; color: #666;">Copy the code below and email/text it to the next family.</p>
            <textarea id="save-code-output" readonly onclick="this.select()"></textarea>
        </div>

        <div class="control-group">
            <strong>2. Load someone else's changes:</strong><br>
            <p style="font-size: 0.85rem; color: #666;">Paste the code you received here and click "Load".</p>
            <textarea id="load-code-input" placeholder="Paste code here..."></textarea>
            <button class="secondary" onclick="loadFromCode()">Load Calendar Data</button>
            <div id="load-status" class="status-msg"></div>
        </div>
        
        <div class="control-group" style="margin-top:30px; text-align: right;">
            <button style="background-color: #c0392b; font-size: 0.8rem;" onclick="clearAllData()">Reset Entire Calendar</button>
        </div>
    </div>
</div>

<script>
    // Configuration for the requested months in 2026
    const year = 2026;
    const months = [
        { name: "May", index: 4 },      // JS months are 0-indexed (0=Jan, 4=May)
        { name: "June", index: 5 },
        { name: "July", index: 6 },
        { name: "August", index: 7 },
        { name: "September", index: 8 }
    ];

    // State object to hold unavailable dates. Format: "YYYY-MM-DD": true
    let unavailableDates = {};

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
        loadFromLocalStorage();
        renderCalendars();
    });

    function renderCalendars() {
        const wrapper = document.getElementById('calendar-wrapper');
        wrapper.innerHTML = ''; // Clear existing

        months.forEach(month => {
            const monthDiv = document.createElement('div');
            monthDiv.className = 'month-container';

            // Header
            const header = document.createElement('div');
            header.className = 'month-header';
            header.innerText = `${month.name} ${year}`;
            monthDiv.appendChild(header);

            // Days of week header
            const daysHeader = document.createElement('div');
            daysHeader.className = 'days-header';
            ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(d => {
                const dayName = document.createElement('div');
                dayName.className = 'day-name';
                dayName.innerText = d;
                daysHeader.appendChild(dayName);
            });
            monthDiv.appendChild(daysHeader);

            // Calendar Grid
            const grid = document.createElement('div');
            grid.className = 'calendar-grid';

            // Calculate days
            const firstDay = new Date(year, month.index, 1).getDay();
            const daysInMonth = new Date(year, month.index + 1, 0).getDate();

            // Empty cells for days before the 1st
            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'day-cell empty';
                grid.appendChild(emptyCell);
            }

            // Actual days
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'day-cell';
                cell.innerText = day;
                
                // Construct date key YYYY-MM-DD
                // Ensure 2 digits for month and day
                const monthStr = String(month.index + 1).padStart(2, '0');
                const dayStr = String(day).padStart(2, '0');
                const dateKey = `${year}-${monthStr}-${dayStr}`;

                cell.dataset.date = dateKey;

                // Check if unavailable
                if (unavailableDates[dateKey]) {
                    cell.classList.add('unavailable');
                }

                // Click event
                cell.addEventListener('click', () => toggleDate(dateKey, cell));

                grid.appendChild(cell);
            }

            monthDiv.appendChild(grid);
            wrapper.appendChild(monthDiv);
        });
    }

    function toggleDate(dateKey, cellElement) {
        if (unavailableDates[dateKey]) {
            delete unavailableDates[dateKey];
            cellElement.classList.remove('unavailable');
        } else {
            unavailableDates[dateKey] = true;
            cellElement.classList.add('unavailable');
        }
        saveToLocalStorage();
    }

    // --- Data Persistence Functions ---

    function saveToLocalStorage() {
        localStorage.setItem('familyScheduler2026', JSON.stringify(unavailableDates));
    }

    function loadFromLocalStorage() {
        const stored = localStorage.getItem('familyScheduler2026');
        if (stored) {
            try {
                unavailableDates = JSON.parse(stored);
            } catch (e) {
                console.error("Error loading data", e);
                unavailableDates = {};
            }
        }
    }

    function generateSaveCode() {
        const jsonString = JSON.stringify(unavailableDates);
        // Base64 encode to make it look like a "code" and avoid special char issues in copy/paste
        const code = btoa(jsonString);
        const output = document.getElementById('save-code-output');
        output.value = code;
        output.select();
        document.execCommand('copy'); // Fallback for older browsers
        
        // Modern clipboard API
        if (navigator.clipboard) {
            navigator.clipboard.writeText(code);
        }

        const status = document.getElementById('copy-status');
        status.innerText = "Code copied to clipboard! Send this to your family.";
        setTimeout(() => status.innerText = "", 5000);
    }

    function loadFromCode() {
        const input = document.getElementById('load-code-input');
        const status = document.getElementById('load-status');
        const code = input.value.trim();

        if (!code) {
            status.innerText = "Please paste a code first.";
            status.style.color = "red";
            return;
        }

        try {
            const jsonString = atob(code);
            const newData = JSON.parse(jsonString);
            
            // Merge logic: You might want to overwrite or merge. 
            // For simplicity and reliability in this context, we will MERGE.
            // This means if Family A marked May 5, and Family B loads it, May 5 stays marked.
            // If Family B marks May 6 and sends it back, both 5 and 6 are marked.
            unavailableDates = { ...unavailableDates, ...newData };
            
            saveToLocalStorage();
            renderCalendars();
            
            status.innerText = "Calendar updated successfully!";
            status.style.color = "green";
            input.value = ""; // Clear input
        } catch (e) {
            status.innerText = "Invalid code. Please check and try again.";
            status.style.color = "red";
        }
    }

    function clearAllData() {
        if(confirm("Are you sure you want to clear all marked dates? This cannot be undone.")) {
            unavailableDates = {};
            saveToLocalStorage();
            renderCalendars();
        }
    }
</script>

</body>
</html>